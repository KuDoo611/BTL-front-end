<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <script src="https://code.jquery.com/jquery-2.2.4.min.js"
    integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
  <style>
  </style>

  <script>
    $(document).ready(function () {
  // Sự kiện click cho nav-item.dropdown
  $('.nav-item.dropdown').click(function (e) {
    e.preventDefault();

    // Hiển thị hoặc ẩn dropdown-menu
    $(this).find('.dropdown-menu').slideToggle();
  });

  var hiddenProducts = $('.product-box:gt(2)').hide();

  $('.btn-show-more').click(function () {
    hiddenProducts.slice(0, 3).fadeIn();

    hiddenProducts = hiddenProducts.slice(3);

    if (hiddenProducts.length === 0) {
      $('.btn-show-more').hide();
    }
  });

  // Xử lý khi modal đăng nhập được đóng
  $('#loginModal').on('hidden.bs.modal', function () {
    // Xóa dữ liệu trong modal sau khi nó được đóng
    $('#loginUsername').val('');
    $('#loginPassword').val('');
  });

  // Xử lý khi modal đăng ký được đóng
  $('#signupModal').on('hidden.bs.modal', function () {
    // Xóa dữ liệu trong modal sau khi nó được đóng
    $('#signupUsername').val('');
    $('#signupPassword').val('');
  });

   // Xử lý đăng nhập
   $('#loginForm').submit(function (event) {
    event.preventDefault();
    var username = $('#loginUsername').val();
    var password = $('#loginPassword').val();

    // Kiểm tra tài khoản và mật khẩu với danh sách người dùng
    var users = JSON.parse(localStorage.getItem('users')) || [];
    var user = users.find(function (u) {
      return u.username === username && u.password === password;
    });

    if (user) {
      // Đăng nhập thành công
      alert('Đăng nhập thành công với tài khoản: ' + username);

      // Kiểm tra vai trò của người dùng
      if (user.role === 'admin') {
        // Nếu là admin, hiển thị nút Xem Danh Sách Người Dùng
        $('.dropdown-menu').html('<li class="logout-btn"><a class="dropdown-item" href="#" onclick="logout()">Đăng Xuất</a></li><li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#userListModal">Xem Danh Sách Người Dùng</a></li>');
      } else {
        // Nếu là user, ẩn nút Xem Danh Sách Người Dùng
        $('.dropdown-menu').html('<li class="logout-btn"><a class="dropdown-item" href="#" onclick="logout()">Đăng Xuất</a></li>');
      }

      // Có thể thực hiện các hành động khác sau khi đăng nhập thành công
      // Ví dụ: Hiển thị tên người dùng ở góc trên cùng
      $('.nav-link.dropdown-toggle').html('<i class="bi bi-person-circle"></i> ' + username);
    } else {
      // Đăng nhập thất bại
      alert('Tài khoản hoặc mật khẩu không đúng');
    }

    // Sau khi xử lý xong, bạn có thể ẩn modal bằng cách sử dụng:
    $('#loginModal').modal('hide');
  });

  // Xử lý đăng ký
$('#signupForm').submit(function (event) {
  event.preventDefault();
  var username = $('#signupUsername').val();
  var password = $('#signupPassword').val();
  var role = $('#userRole').val(); // Lấy giá trị của trường role

  // Kiểm tra xem tài khoản đã tồn tại chưa
  var users = JSON.parse(localStorage.getItem('users')) || [];
  var existingUser = users.find(function (u) {
    return u.username === username;
  });

  if (existingUser) {
    // Tài khoản đã tồn tại
    alert('Tài khoản đã tồn tại. Vui lòng chọn tên đăng nhập khác.');
  } else {
    // Thêm thông tin tài khoản mới vào danh sách
    users.push({ username: username, password: password, role: role });
    // Lưu danh sách người dùng vào localStorage
    localStorage.setItem('users', JSON.stringify(users));

    // Hiển thị thông báo đăng ký thành công
    alert('Đăng ký thành công!');

    // Sau khi xử lý xong, bạn có thể ẩn modal bằng cách sử dụng:
    $('#signupModal').modal('hide');
  }
});

  // Xử lý sự kiện click cho nút Xem Danh Sách Người Dùng
$('#userListModal').on('show.bs.modal', function () {
  // Lấy danh sách người dùng từ localStorage
  var users = JSON.parse(localStorage.getItem('users')) || [];

  // Hiển thị danh sách người dùng trong bảng
  var userListBody = $('#userListBody');
  userListBody.empty(); // Xóa dữ liệu cũ

  if (users.length > 0) {
    users.forEach(function (user, index) {
      userListBody.append('<tr><th scope="row">' + (index + 1) + '</th><td>' + user.username + '</td><td>' + user.password + '</td><td>' + user.role + '</td><td><button class="btn btn-danger btn-sm" onclick="deleteUser(' + index + ')">Xóa</button></td></tr>');
    });
  } else {
    // Không có người dùng
    userListBody.append('<tr><td colspan="5">Không có người dùng.</td></tr>');
  }
});


  // Ẩn modal
  $('#closeButton').click(function () {
    $('#loginModal').modal('hide');
  });
});

// Hàm lưu thông tin tài khoản vào localStorage
function saveCredentials(username, password) {
  // Kiểm tra xem đã có danh sách người dùng trong localStorage chưa
  var users = JSON.parse(localStorage.getItem('users')) || [];

  // Thêm thông tin tài khoản mới vào danh sách
  users.push({ username: username, password: password });

  // Lưu danh sách người dùng vào localStorage
  localStorage.setItem('users', JSON.stringify(users));
}

// Hàm xóa tài khoản
function deleteUser(index) {
  // Lấy danh sách người dùng từ localStorage
  var users = JSON.parse(localStorage.getItem('users')) || [];

  // Xóa người dùng khỏi danh sách
  users.splice(index, 1);

  // Lưu danh sách người dùng vào localStorage
  localStorage.setItem('users', JSON.stringify(users));

  // Hiển thị lại danh sách người dùng trong modal
  $('#userListModal').modal('show');
}

// Hàm đăng xuất
function logout() {
  // Ẩn nút Đăng Xuất, hiển thị nút Đăng Nhập và Đăng Ký
  $('.dropdown-menu').html('<li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Đăng Nhập</a></li><li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#signupModal">Đăng Ký</a></li><li class="logout-btn" style="display:none;"><a class="dropdown-item" href="#" onclick="logout()">Đăng Xuất</a></li><li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#userListModal">Xem Danh Sách Người Dùng</a></li>');

  // Ẩn biểu tượng người dùng và hiển thị lại biểu tượng mặc định
  $('.nav-link.dropdown-toggle').html('<i class="bi bi-person-circle"></i>');
}

  </script>
</head>

<body>
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img
          src="https://png2.cleanpng.com/dy/45e6cd34d6b60489f2a8f4ed3ac6a02e/L0KzQYm3VsEyN5pth5H0aYP2gLBuTgJwgZJxjOs2ZoLodX7zjBdwNZh3eeJxaXOwdLb6ifdvNWZnSddtMHXkRIHqUfM1NmI9TaoDNUG6QYa5WMc1PmM2UKQBNUOxgLBu/kisspng-royalty-free-logo-graphic-design-5b1ed0ea40c1c4.1858851715287462182653.png"
          alt="Logo" height="60">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item dropdown">
            <a class="nav-link " href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Dịch vụ quảng cáo
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Sản phẩm</a></li>
              <li><a class="dropdown-item" href="#">Another action</a></li>
              <li><a class="dropdown-item" href="#">Something else here</a></li>
            </ul>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link " href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Hỗ Trợ khách hàng
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Câu hỏi thường gặp</a></li>
              <li><a class="dropdown-item" href="#">Góp ý sản phẩm dịch vụ</a></li>
              <li><a class="dropdown-item" href="#">liên hệ</a></li>
            </ul>
          </li>
          <li class="nav-item me-1">
            <form class="d-flex" role="search">
              <input class="form-control " type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success" type="submit"><i class="bi bi-search"></i></button>
            </form>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="bi bi-person-circle"></i> Tài khoản
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#loginModal"><i class="bi bi-box-arrow-in-right"></i> Đăng Nhập</a></li>
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#signupModal"><i class="bi bi-person-plus-fill"></i> Đăng Ký</a></li>
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#userListModal">Xem Danh Sách Người Dùng</a></li>
            </ul>
          </li>
        </div>
      </nav>
    
  <!-- Modal đăng nhập -->
  <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="loginModalLabel">Đăng Nhập</h5>
          <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close" id="closeButton"></button>
        </div>
        <div class="modal-body">
          <form id="loginForm">
            <div class="form-group">
              <label for="loginUsername">Username:</label>
              <input type="text" class="form-control" id="loginUsername" required>
            </div>
            <div class="form-group">
              <label for="loginPassword">Password:</label>
              <input type="password" class="form-control" id="loginPassword" required>
            </div>
            <button type="submit" class="btn btn-primary">Đăng Nhập</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal đăng ký -->
<div class="modal fade" id="signupModal" tabindex="-1" role="dialog" aria-labelledby="signupModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="signupModalLabel">Đăng Ký</h5>
        <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close" id="closeButton"></button>
      </div>
      <div class="modal-body">
        <form id="signupForm">
          <div class="form-group">
            <label for="signupUsername">Username:</label>
            <input type="text" class="form-control" id="signupUsername" required>
          </div>
          <div class="form-group">
            <label for="signupPassword">Password:</label>
            <input type="password" class="form-control" id="signupPassword" required>
          </div>
          <div class="form-group">
            <label for="userRole">Role:</label>
            <select class="form-control" id="userRole" required>
              <option value="user">User</option>
              <option value="admin">Admin</option>
            </select>
          </div>
          <button type="submit" class="btn btn-success">Đăng Ký</button>
        </form>
      </div>
    </div>
  </div>
</div>
  <!-- Modal hiển thị danh sách người dùng -->
  <div class="modal fade" id="userListModal" tabindex="-1" role="dialog" aria-labelledby="userListModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="userListModalLabel">Danh Sách Người Dùng</h5>
          <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close" id="closeButton"></button>
        </div>
        <div class="modal-body">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">STT</th>
                <th scope="col">Username</th>
                <th scope="col">Password</th>
                <th scope="col">Quyền</th>
                <th scope="col">Thao tác</th>
              </tr>
            </thead>
            <tbody id="userListBody">
              <!-- Dữ liệu người dùng sẽ được thêm vào đây bằng JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

</body>

</html>
